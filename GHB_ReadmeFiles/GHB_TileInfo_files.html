<html>
	<head>
		<style>
			html {
			background-color: white;
			color: black;
			font-family: sans-serif;
			}
			
			table, th, td {
			border: 1px solid black;
			border-collapse: collapse;
			}
			
			span.NoLineBreak {
				white-space: nowrap;
			}
		</style>
	</head>
<h1>GHB's tilemap info</h1>
Unlike most other layer 3 status bar patches, tile conversion to coordinates is completely different. Instead of having all the tiles all together in the tilemap, each horizontal lines of 8x8 tiles are split into each
4 &ldquo;screens&rdquo; of the tilemap:<br>
<a href="GHB_ReadmeFiles/SMB3_Statusbar_Tilemap.png" target="_blank"><img width="256" src="GHB_ReadmeFiles/SMB3_Statusbar_Tilemap.png"></a><br>
Thankfully, <a href="https://github.com/devinacker/bsnes-plus/releases">Bsnes+ v4</a> (or higher) tile coordinate system is updated to show its position
relative to each one of the 4 screens instead of the top-left corner of all 4 screens. The map number can be used as the &ldquo;row number/Y position&rdquo;.<br><br>

To obtain the coordinate of the selected tile, run Bsnes+, and on any level, go to Tools &rightarrow; Debugger &rightarrow; S-PPU &rightarrow; Tilemap Viewer and 
select &ldquo;3&rdquo; on the BG layer, and enable &ldquo;Auto Update&rdquo;. Because the status bar writing is timing-based when drawing the screen, there is
a chance that the tilemap will only display layer 3 non-status bar (layer 3 backgrounds, for example) as the debugger only displayed it during non-status bar write,
therefore a breakpoint and &ldquo;stepping&rdquo; around $0082A4 will help. After that, select any status bar tile, you should get the map number (Y position for this table)
and the first number in &ldquo;Position&rdquo; (X position for this table):<br>
<a href="GHB_ReadmeFiles/SMB3_Statusbar_TileCoord.png" target="_blank"><img width="256" src="GHB_ReadmeFiles/SMB3_Statusbar_TileCoord.png"></a><br>
Then on this HTML file, CTRL+F and enter <kbd>(&lt;X_position&gt;,&lt;MapNumber&gt;)</kbd> (including the quotes) with no leading zeroes.<br><br>

The following is two address, enter the RAM address presented on the Asar console window (the starting address, of <b>all tiles</b>, not ending) if you have edited the RAM addresses or use SA-1.
I made this JS table-er to make it easy to locate what RAM of a given tile without using a calculator.<br><br>

<kbd>!status_tile = $<input type="text" list="StatusBarRAMTileList" id="RAM_TTTTTTTT_Addr" value ="7FB600" maxlength="6" onchange="Calculate()"></kbd><button type="button" onclick="IncreaseDecreaseRAM(1, 'RAM_TTTTTTTT_Addr')">+</button><button type="button" onclick="IncreaseDecreaseRAM(-1, 'RAM_TTTTTTTT_Addr')">-</button>
<datalist id="StatusBarRAMTileList">
<option value="7FB600">Default RAM address</option>
<option value="40C700">Default RAM address (SA-1)</option>
</datalist><br>
<kbd>!status_prop = $<input type="text" list="StatusBarRAMPropertiesList" id="RAM_YXPCCCTT_Addr" value ="7FB680" maxlength="6" onchange="Calculate()"></kbd></kbd><button type="button" onclick="IncreaseDecreaseRAM(1, 'RAM_YXPCCCTT_Addr')">+</button><button type="button" onclick="IncreaseDecreaseRAM(-1, 'RAM_YXPCCCTT_Addr')">-</button>
<datalist id="StatusBarRAMPropertiesList">
<option value="7FB680">Default RAM address</option>
<option value="40C780">Default RAM address (SA-1)</option>
</datalist><br>

<button onclick="AutoFillSa1()">Autofill SA-1 addresses</button>
<button onclick="Reset()">Reset</button>
<hr>
<body onload="Calculate()">
<span id="Output"></span>
<script>
	function AutoFillSa1() {
		document.getElementById("RAM_TTTTTTTT_Addr").value = "40C700"
		document.getElementById("RAM_YXPCCCTT_Addr").value = "40C780"
		Calculate()
	}
	function IncreaseDecreaseRAM(ChangeBy, WhatInput) {
		document.getElementById(WhatInput).value = clamp((parseInt(document.getElementById(WhatInput).value, 16) + parseInt(ChangeBy, 10)), 0, parseInt("FFFFFF", 16)).toString(16).toUpperCase()
		Calculate()
	}
	function clamp(num, min, max) {
		if (isNaN(num) == true) {
			num = 0
		}
		return num <= min ? min : num >= max ? max : num;
	}
	function Reset() {
		document.getElementById("RAM_TTTTTTTT_Addr").value = "7FB600"
		document.getElementById("RAM_YXPCCCTT_Addr").value = "7FB680"
		Calculate()
	}
	function Calculate() {
		//Clear output
			document.getElementById("Output").innerHTML = ""
			var Output = ""
		//DisplayOutput
			var RAM_TileNumbAddr = clamp(parseInt(document.getElementById("RAM_TTTTTTTT_Addr").value, 16), 0, parseInt("FFFFFF", 16))
			document.getElementById("RAM_TTTTTTTT_Addr").value = (RAM_TileNumbAddr).toString(16).toUpperCase()
			var RAM_TilePropAddr = clamp(parseInt(document.getElementById("RAM_YXPCCCTT_Addr").value, 16), 0, parseInt("FFFFFF", 16))
			document.getElementById("RAM_YXPCCCTT_Addr").value = (RAM_TilePropAddr).toString(16).toUpperCase()
			
			Output += "<table>"
			Output += "<tr><td>Tile number address range:</td><td><kbd>$" + RAM_TileNumbAddr.toString(16).toUpperCase() + "</kbd> to <kbd>$" + (RAM_TileNumbAddr+(32*4)-1).toString(16).toUpperCase() + "</td></tr>"
			Output += "<tr><td>Tile properties address range:</td><td><kbd>$" + RAM_TilePropAddr.toString(16).toUpperCase() + "</kbd> to <kbd>$" + (RAM_TilePropAddr+(32*4)-1).toString(16).toUpperCase() + "</td></tr>"
			Output += "</table><br>"
			
			var TileCount = 0
			var Xpos = 0
			var YPos = 0
			Output += "<table>"
			Output += "<tr><th>Tile number and coordinates</th><th>Tile number (TTTTTTTT)</th><th>Tile properties (YXPCCCTT)</th></tr>"
			while (TileCount < (32*4)) {
				Xpos = (TileCount % 32)
				YPos = Math.floor(TileCount/32)
				if (Xpos == 0) {
					Output += "<tr><th colspan='3'>Map/Screen " + YPos.toString(10) + "</th></tr>"
				}
				Output += "<tr>"
				Output += "<td><kbd>" + TileCount.toString(10) + "</kbd> (<kbd>$" + TileCount.toString(16).toUpperCase() + "</kbd>), position: <kbd>(" + Xpos.toString(10) + "," + YPos.toString(10) + ")</kbd>" + " (<kbd>($" + Xpos.toString(16).toUpperCase() + ",$" + YPos.toString(16).toUpperCase() + ")</kbd>)</td>"
				Output += "<td><kbd>$" + (RAM_TileNumbAddr + TileCount).toString(16).toUpperCase() + "</kbd></td>"
				Output += "<td><kbd>$" + (RAM_TilePropAddr + TileCount).toString(16).toUpperCase() + "</kbd></td>"
				Output += "</tr>"
				TileCount++
			}
			Output += "</table>"

			document.getElementById("Output").innerHTML = Output
	}


</script>